{% set bodyClass = 'location' %}

{% extends "_layouts/site" %}

{% block main %}

<div class="grid-x">
  <div class="small-12 cell">
    <div id="map" style="width: 100%; height: 500px" class="margin-bottom-1"></div>
  </div>
</div>

<!-- Copy -->
<div class="grid-container padding-vertical-3">
  <div class="grid-x grid-padding-x grid-padding-y align-center align-middle">
    <div class="small-12 medium-10 large-9 cell text-center">
      {{entry.copy}}
    </div>
  </div>
</div>
<!-- End Copy -->

<!-- Address + Date -->
<div class="grid-container padding-bottom-1">
  <div class="grid-x grid-padding-x grid-padding-y align-center align-middle">
    <div class="small-12 medium-10 large-9 cell text-center">
      <h3 class="primary-color">{{event.address}}</h3>
      <h3 class="primary-color">{{event.startDate|date('j')}} - {{event.finishDate|date('j F Y')}}</h3>
    </div>
  </div>
</div>
<!-- End Address + Date -->

<!-- Transport -->
<div class="grid-container">
  <div class="grid-x grid-padding-x grid-padding-y small-up-1 medium-up-2 large-up-4">
    {% for transport in entry.transport.all() %}
      <div class="cell">
        <h2 class="sans-display">{{ transport.header }}</h2>
        {{ transport.copy }}
      </div>
    {% endfor %}
  </div>
</div>
<!-- End Transport  -->

{% js %}
mapboxgl.accessToken = "pk.eyJ1IjoiZ2FyZXRoam9obnNkZXNpZ24iLCJhIjoiY2sxbnV1NGhmMGE4YTNvb2l1aGp5ano3ZiJ9.g6KdDp-CdRZI2KzanoxFQw";

var map = new mapboxgl.Map({
  container: 'map',
  style: 'mapbox://styles/garethjohnsdesign/ck1qcw4jy09aj1cpdwf0xqiec?optimize=true',
  center: [{{event.location.lng}}, {{event.location.lat}}],
  zoom: 12
});

var geojson = {
  type: 'FeatureCollection',
  features: 
  [
  {
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [{{event.location.lng}}, {{event.location.lat}}]
    },
  },
  ]
};
 
  // add markers to map
  geojson.features.forEach(function(marker) {

  // create a HTML element for each feature
  var el = document.createElement('div');
  el.className = 'marker';

  // make a marker for each feature and add to the map
  new mapboxgl.Marker(el)
    .setLngLat(marker.geometry.coordinates)
    .addTo(map);
});

map.addControl(new mapboxgl.NavigationControl(), 'bottom-right');
map.addControl(new mapboxgl.GeolocateControl ({positionOptions: {enableHighAccuracy: true},trackUserLocation: true}), 'bottom-left');

// disable map zoom when using scroll
map.scrollZoom.disable();

{% endjs %}

{% endblock %}